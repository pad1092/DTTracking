<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Thiết lập cảnh báo thiết bị</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" th:href="@{/css/common.css}">
  <link rel="stylesheet" th:href="@{/css/main.css}">
  <link rel="shortcut icon" th:href="@{/images/logo.png}" type="image/x-icon">
</head>

<body>
<div id="header" class="header">
  <div class="header-wrapper">
    <div class="navbar">
      <div class="header-left h-100">
        <a th:href="@{/home}" class="d-block h-100">
          <h4 class="m-0 f-w-bold">DTTRACKING</h4>
        </a>
      </div>
      <div class="header-right flex-1">
        <ul class="header-right-link">
          <li class="mx-2 list-unstyled d-inline-block nav-item ">
            <a th:href="@{/users/devices}" class="nav-link">
              <i class="fa-solid fa-walkie-talkie mr-1"></i>
              Quản lý thiết bị
            </a>
          </li>
          <li class="mx-2 list-unstyled d-inline-block nav-item">
            <a th:href="@{/users/tracking}" class="nav-link text-center d-block">
              <i class="fa-solid fa-location-crosshairs mr-1"></i>
              Theo dõi</a>
          </li>
          <li class="mx-2 list-unstyled d-inline-block nav-item active">
            <div class="nav-link">
              <i class="fa-regular fa-bell mr-1"></i>
              Quản lý cảnh báo
              <div class="submenu">
                <a th:href="@{/users/danger-zone}" class="submenu-item">Vùng nguy hiểm</a>
                <a th:href="@{/users/leave-position}" class="submenu-item active">Di chuyển khỏi vị trí</a>
              </div>
            </div>
          </li>
          <li class="mx-2 list-unstyled d-inline-block nav-item ">
            <a th:href="@{/users/route}" class="nav-link">
              <i class="fa-solid fa-route mr-1"></i>
              Lộ trình
            </a>
          </li>
        </ul>
        <div class="nav-toggle-btn action-btn" onclick="toggleDropdownMenu()" id="toggle-menu-btn">
          <i class="fa-solid fa-bars" style="color: #232424;"></i>
        </div>
      </div>
      <a>
        <div class="header-user">
          <i class="fa-solid fa-user"></i>
          <div class="py-2" id="user-profile">
            <span class="user-profile-item d-inline-block w-100 py-1 pl-3" onclick="dislayProfileModal()">Thông tin tài khoản</span>
            <span class="user-profile-item d-inline-block w-100 py-1 pl-3" onclick="changePassModal()">Đổi mật khẩu</span>
            <a th:href="@{/logout}" class="user-profile-item d-inline-block w-100 py-1 pl-3 text-white">Đăng xuất</a>
          </div>
        </div>
      </a>
    </div>
    <div class="drop-down-menu">
      <li class="mx-2 list-unstyled d-inline-block nav-item ">
        <a th:href="@{/users/devices}" class="nav-link">
          <i class="fa-solid fa-walkie-talkie mr-1"></i>
          Quản lý thiết bị
        </a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item ">
        <a th:href="@{/users/tracking}" class="nav-link text-center d-block">
          <i class="fa-solid fa-location-crosshairs mr-1"></i>
          Theo dõi</a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item">
        <a th:href="@{/users/danger-zone}" class="nav-link ">
          <i class="fa-solid fa-bell mr-1"></i>
          Vùng nguy hiểm
        </a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item active">
        <a th:href="@{/users/leave-position}" class="nav-link">
          <i class="fa-solid fa-gear mr-1"></i>
          Di chuyển khỏi vị trí
        </a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item ">
        <a th:href="@{/users/route}" class="nav-link">
          <i class="fa-solid fa-route mr-1"></i>
          Lộ trình
        </a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item" onclick="dislayProfileModal()">
        <a  class="nav-link">
          <i class="fa-solid fa-user"></i>
          Tài khoản
        </a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item" onclick="changePassModal()">
        <a  class="nav-link">
          <i class="fa-solid fa-user"></i>
          Đổi mật khẩu
        </a>
      </li>
      <li class="mx-2 list-unstyled d-inline-block nav-item">
        <a th:href="@{/logout}" class="nav-link">
          <i class="fa-solid fa-right-from-bracket"></i>
          Đăng xuất
        </a>
      </li>
    </div>
  </div>
</div>
<div class="body-wrapper">
  <h6 class="pt-5 text-uppercase f-w-bold text-navy mb-4">
    Quản lý cảnh báo
    <i class="fa-solid fa-chevron-right mx-2" style="font-size: 12px;"></i>
    Thiết lập cảnh báo cho thiết bị
  </h6>
  <div class="wr-f-500 align-items-center" style="display:flex">
  </div>
  <select id="device-slt" class="form-control w-25" onchange="changeSelectedDevice(value)">
    <option value="" selected disabled>Chọn thiết bị</option>
  </select>
  <div class="mt-3">
    <div id="list-device" class="tbl-wrapper mt-2" style="box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px; max-height: 50vh;">
      <table class=" bg-light table table-hover border table-responsive-lg text-center table-striped" id="alert-device-tbl">
        <thead class="bg-brown text-white">
        <tr>
          <th scope="col" class="col-1">STT</th>
          <th scope="col" class="col-2">Tên</th>
          <th scope="col" class="col-2">Mô tả</th>
          <th scope="col" class="col-2">Loại cảnh báo</th>
          <th scope="col" class="col-2">Thời gian bắt đầu</th>
          <th scope="col" class="col-2">Khoảng thời gian</th>
          <th scope="col" class="col-1">Hành động</th>
        </tr>
        </thead>
        <tbody>
<!--        <tr>-->
<!--           <th scope="row">1</th>-->
<!--           <td>Kim Ánh</td>-->
<!--           <td>Dayoff weekend</td>-->
<!--           <td class="text-danger">-->
<!--               Vùng nguy hiểm-->
<!--           </td>-->
<!--           <td>12AM</td>-->
<!--           <td>12h30m</td>-->
<!--           <td><i class="fa-regular fa-trash-can text-danger"></i></td>-->
<!--       </tr>-->
        </tbody>
      </table>
      <img id="loading-alert-device-tbl" th:src="@{/images/2ring-loading.svg}" class="m-auto pb-3"
           style="width: 30px; filter: brightness(0.3); display: none"/>
      <span class="text-center pb-3" id="alert-devcie-tbl-empty" style="display: none">
        Thiết bị chưa được thiết lập cảnh báo
      </span>
    </div>
    <div class="mt-3 d-flex justify-content-end">
      <span id="addAlertBtn" class="btn btn-success disabled" onclick="openAddModal(event)">Thêm mới</span>
    </div>
  </div>
</div>

<!-- ADD MODAL -->
<div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header text-white">
        <h5 class="modal-title text-center" id="exampleModalLabel">Thêm cảnh báo cho thiết bị</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="addItemForm">
          <span class="f-w-bold my-1">Khoảng thời gian</span>
          <div class="d-flex w-100 mb-3">
            <div class="w-50 mx-2">
              <label class="mb-1" for="time-imp">Thời gian bắt đầu</label>
              <input type="time" class="form-control text-center" id="time-imp" onchange="changeTime(value)">
            </div>
            <div class="w-50 mx-2">
              <label class="mb-1" >Kết thúc sau (giờ : phút)</label>
              <div type="time" class="form-control d-flex">
                <input class="w-50 h-100 pr-1 text-right" style="border: none; outline: none;" type="text"
                       placeholder="giờ" id="inp-hour" onchange="inputHour(val)" oninput="inputHour(value)">:
                <input class="w-50 h-100 pl-1 text-left" style="border: none; outline: none;"
                       type="number" step="5" min="0" max="55" placeholder="phút" id="input-minute"
                       oninput="inputMinute(value)" onchange="onchangeMinute(value)">
              </div>
            </div>
          </div>
          <span class="f-w-bold my-1">Bộ lọc tìm kiếm</span>
          <div class="d-flex w-100 mb-1">
            <div class="w-50 mx-2">
              <label class="mb-1" for="inp-alert-name">Từ khóa</label>
              <input id="inp-alert-name" type="text" class="form-control" placeholder="Nhập tên hoặc mô tả" oninput="searchAlert(value)">
            </div>
            <div class="w-50 mx-2">
              <label class="mb-1" for="sl-alert-type" >Loại cảnh báo</label>
              <select id="sl-alert-type" class="form-control" onchange="searchAlert(value)">
                <option value="ALL" selected>Tất cả</option>
                <option value="IN">Vùng nguy hiểm</option>
                <option value="OUT">Rời vị trí</option>
              </select>
            </div>
          </div>
          <div id="list-search-alert" class="tbl-wrapper mx-2 border-top mb-2" style="box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px; height: 200px; font-size: 14px;">
            <table class=" bg-light table table-hover border table-responsive-lg text-center table-striped" id="search-alert-tbl">
              <thead class="bg-white">
              <tr>
                <th scope="col" class="col-1">STT</th>
                <th scope="col" class="col-2">Tên</th>
                <th scope="col" class="col-2">Mô tả</th>
                <th scope="col" class="col-2">Loại cảnh báo</th>
              </tr>
              </thead>
              <tbody>
              <!-- <tr>
                 <th scope="row">1</th>
                 <td>Kim Ánh</td>
                 <td>Dayoff weekend</td>
                 <td class="text-danger">
                     Vùng nguy hiểm
                 </td>
             </tr> -->
              </tbody>
            </table>
            <img th:src="@{/images/2ring-loading.svg}" class="m-auto pb-3 d-none" style="width: 30px; filter: brightness(0.3);"/>
            <span class="text-center" id="search-alert-empt" style="display: none">Không tìm thấy dữ liệu</span>
          </div>
          <span id="msg-add-zone" class="text-danger mt-2"></span>
        </form>
        <div class="d-flex justify-content-end">
          <button id="add-zone-btn" class="btn btn-primary mt-2 px-4" onclick="addAlertForDevice()">Lưu</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script th:src="@{/js/main.js}"></script>
<script th:src="@{/js/user/alert-device.js}"></script>
</body>

</html>